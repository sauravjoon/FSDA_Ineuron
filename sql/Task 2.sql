USE INEURON_SQL_PROJECT;

-- TASK 2
CREATE TABLE PHONES (
    NAME VARCHAR(20) NOT NULL,
    PHONE_NUMBER INT NOT NULL,
    UNIQUE(NAME, PHONE_NUMBER)
);

CREATE TABLE CALLS (
    ID INT NOT NULL,
    CALLER INT NOT NULL,
    CALLEE INT NOT NULL,
    DURATION INT NOT NULL,
    UNIQUE(ID)
);

INSERT INTO PHONES VALUES
('JACK', 1234),
('LENA', 3333),
('MARK', 9999),
('ANNA', 7582);

INSERT INTO CALLS VALUES
(25, 1234, 7582, 8),
(7, 9999, 7582, 1),
(18, 9999, 3333, 4),
(2, 7582, 3333, 3),
(3, 3333, 1234, 1),
(21, 3333, 1234, 1);

SELECT * FROM PHONES;
SELECT * FROM CALLS;

SELECT P.NAME
FROM PHONES P
JOIN CALLS C
ON P.PHONE_NUMBER = C.CALLER OR P.PHONE_NUMBER = C.CALLEE
GROUP BY P.NAME
HAVING SUM(C.DURATION) >= 10
ORDER BY P.NAME;
